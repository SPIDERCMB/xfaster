

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quick Start &mdash; xfaster 1.2.0.post1.dev20+g98385f3 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=eb8d8f31"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "tags": "ams", "useLabelIds": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Algorithm" href="algorithm.html" />
    <link rel="prev" title="XFaster Documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            xfaster
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-script">Example Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-your-data">Setting up your data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#map-data">Map Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#non-map-data">Non-Map Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#running-the-code">Running the code</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-the-outputs">Reading the outputs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algorithm.html">Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/XFaster_Tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">xfaster</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Quick Start</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/quickstart.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="quick-start">
<h1>Quick Start<a class="headerlink" href="#quick-start" title="Link to this heading"></a></h1>
<p>In this page we’ll go over the basics of using the code and its outputs.</p>
<section id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">healpy</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">camb</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">emcee</span></code> (only for likelihoods)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">h5py</span></code> (only for likelihoods)</p></li>
</ul>
<p>XFaster is compatible with Python versions 3.0 and higher.</p>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading"></a></h2>
<p>To use the latest release version of xfaster, install via pip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install xfaster
</pre></div>
</div>
<p>Otherwise, for development work, clone the repo (<a class="reference external" href="https://github.com/SPIDERCMB/xfaster">https://github.com/SPIDERCMB/xfaster</a>) and install manually:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install .
</pre></div>
</div>
<p>Or, if installing on a shared machine:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install . --user
</pre></div>
</div>
<p><strong>Note:</strong> Every time you pull or make local changes to files in <code class="docutils literal notranslate"><span class="pre">xfaster/xfaster</span></code>, you must reinstall for them to take effect.
XFaster is under active development as we add new features– if something is broken, try to git pull and reinstall!</p>
</section>
<section id="example-script">
<h2>Example Script<a class="headerlink" href="#example-script" title="Link to this heading"></a></h2>
<p>To get started with the code before running it on your data, you can run through the example, described in more detail in the <a class="reference internal" href="notebooks/XFaster_Tutorial.html#Tutorial"><span class="std std-ref">Tutorial</span></a> link.
First, generate the small ensemble of maps by running <a class="reference external" href="https://github.com/SPIDERCMB/xfaster/blob/main/example/make_example_maps.py">make_example_maps.py</a> in the <code class="docutils literal notranslate"><span class="pre">examples</span></code> directory.
This should take about 15 minutes on an 8-core laptop.
Then, run <a class="reference external" href="https://github.com/SPIDERCMB/xfaster/blob/main/example/xfaster_example.py">xfaster_example.py</a>.
This should take about 20 minutes with 8 cores.
This runs XFaster on the example maps, so you can see the step-by-step process and look at the outputs, as demonstrated <a class="reference internal" href="#reading-the-outputs"><span class="std std-ref">below</span></a>.</p>
</section>
<section id="setting-up-your-data">
<h2>Setting up your data<a class="headerlink" href="#setting-up-your-data" title="Link to this heading"></a></h2>
<section id="map-data">
<h3>Map Data<a class="headerlink" href="#map-data" title="Link to this heading"></a></h3>
<p>The code requires a certain directory structure for your input maps:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;data_root&gt;/
├── data_&lt;data_type&gt;
│   ├── &lt;data_subset1&gt;
│   │   ├── map_&lt;tag1&gt;.fits
│   │   ├── ...
│   │   ├── map_&lt;tagN&gt;.fits
│   ├── &lt;data_subset2&gt; (same filenames as &lt;data_subset1&gt;)
│   ├── ....
│   ├── &lt;data_subsetM&gt;
├── signal_&lt;signal_type&gt;
│   ├── spec_signal_&lt;signal_type&gt;.dat
│   ├── &lt;data_subset1&gt;
│   │   ├── map_&lt;tag1&gt;_0000.fits
│   │   ├── ...
│   │   ├── map_&lt;tag1&gt;_####.fits
│   │   ├── ...
│   │   ├── map_&lt;tagN&gt;_0000.fits
│   │   ├── ...
│   │   ├── map_&lt;tagN&gt;_####.fits
│   ├── ....
│   ├── &lt;data_subsetM&gt; (same filenames as &lt;data_subset1&gt;)
├── noise_&lt;noise_type&gt; (same filenames as signal_&lt;signal_type&gt;)
├── masks_&lt;mask_type&gt;
│   ├── mask_map_&lt;tag1&gt;.fits
│   ├── ...
│   ├── mask_map_&lt;tagN&gt;.fits
[[optional:]]
├── foreground_&lt;foreground_type_sim&gt; (same filenames as signal_&lt;signal_type&gt;)
├── templates_&lt;template_type&gt;
│   ├── template1 (same filenames as data_&lt;data_type&gt;)
│   ├── template2 (same filenames as data_&lt;data_type&gt;)
└── reference_&lt;reference_type&gt;
    ├── reference1 (same filenames as data_&lt;data_type&gt;)
    └── reference2 (same filenames as data_&lt;data_type&gt;)
</pre></div>
</div>
<p>The required types of maps are data, signal simulations, noise simulations, and masks.
Each map should have a tag, which is used consistently across these different map types.
This would typically be a frequency or some subset of detectors.
For example, SPIDER has two tags: <code class="docutils literal notranslate"><span class="pre">95</span></code> and <code class="docutils literal notranslate"><span class="pre">150</span></code>.</p>
<p>Further subsetting of the data, ie., by time splits, is done through use of the <code class="docutils literal notranslate"><span class="pre">&lt;data_subset&gt;&gt;</span></code> directories.
These should contain independent subsets of data, as they are used to construct cross-spectra.
For example, SPIDER has four subsets, labeled <code class="docutils literal notranslate"><span class="pre">1of4</span></code>, <code class="docutils literal notranslate"><span class="pre">2of4</span></code>, etc, to contain maps from every fourth set of interleaved ten-minute chunks.</p>
<p>For each map tag and for each data subset in your data directory, you must have at least one (but generally at least 100, for reasonable statistics) maps in your signal and noise directories.
These have the same directory structures, but the maps now have additional numerical tags for each realization of randomly generated signal or noise.
The tags don’t have to start at 0 or be contiguous– the code will simply look for any maps in your sim directories that has the same map tag and data_subset as what you’ve picked for the data and use all of them, unless you set an option to say otherwise.
The signal map directory must also contain a spectrum file containing the <span class="math notranslate nohighlight">\(\ell(\ell+1)C_\ell/(2\pi)\)</span> spectra used to create the realizations in the directory.
This spectrum in used in computing the transfer function.</p>
<p>One mask is required per map tag.
These files begin with <code class="docutils literal notranslate"><span class="pre">mask_map_</span></code> instead of <code class="docutils literal notranslate"><span class="pre">map_</span></code>.</p>
<p>Optional inputs are described in <a class="reference internal" href="notebooks/XFaster_Tutorial.html#Tutorial"><span class="std std-ref">Tutorial</span></a>.</p>
</section>
<section id="non-map-data">
<h3>Non-Map Data<a class="headerlink" href="#non-map-data" title="Link to this heading"></a></h3>
<p>The other data you’ll need to provide are your beam window functions and the band centers of the input maps (if fitting for foregrounds).
These are specified in a config file, an example of which is in <a class="reference external" href="https://github.com/SPIDERCMB/xfaster/blob/main/example/config_example.ini">config_example.ini</a>.</p>
<p>Beams can be specified either with a simple FHWM, if using a Gaussian beam model, or with an ell-by-ell beam window function, stored in a <code class="docutils literal notranslate"><span class="pre">.npz</span></code> file.
The <code class="docutils literal notranslate"><span class="pre">.npz</span> <span class="pre">file</span></code> should contain a dictionary with a key for each map tag.
The beams can be an <span class="math notranslate nohighlight">\(\ell\)</span> -length vector, or a 3 <span class="math notranslate nohighlight">\(\times \ell\)</span> - shape array if different beams are desired for Stokes I/Q/U.</p>
</section>
</section>
<section id="running-the-code">
<h2>Running the code<a class="headerlink" href="#running-the-code" title="Link to this heading"></a></h2>
<p>An example of a script to run XFaster can be found in <a class="reference external" href="https://github.com/SPIDERCMB/xfaster/blob/main/example/xfaster_example.py">xfaster_example.py</a>.
This script points to where the data lives, the tags used to fill in options in your file structure tree, what config file to use, and lots of other options you can give to the code.
These aren’t all the options– the API reference for <a class="reference internal" href="api.html#xfaster.xfaster_exec.xfaster_run" title="xfaster.xfaster_exec.xfaster_run"><code class="xref py py-func docutils literal notranslate"><span class="pre">xfaster_run()</span></code></a> contains descriptions of all the arguments you might wish to use.</p>
<p>After setting up your config file and setting the options in your submit script, you then need to decide if you’re submitting this to a cluster (<a class="reference internal" href="api.html#xfaster.xfaster_exec.xfaster_submit" title="xfaster.xfaster_exec.xfaster_submit"><code class="xref py py-func docutils literal notranslate"><span class="pre">xfaster_submit()</span></code></a>) or running it in your current environment (<a class="reference internal" href="api.html#xfaster.xfaster_exec.xfaster_run" title="xfaster.xfaster_exec.xfaster_run"><code class="xref py py-func docutils literal notranslate"><span class="pre">xfaster_run()</span></code></a>).
The example script has both options available.
If submitting to a grid, additional submit options are required, and these are included in the arguments passed to <a class="reference internal" href="api.html#xfaster.xfaster_exec.xfaster_submit" title="xfaster.xfaster_exec.xfaster_submit"><code class="xref py py-func docutils literal notranslate"><span class="pre">xfaster_submit()</span></code></a>.</p>
</section>
<section id="reading-the-outputs">
<h2>Reading the outputs<a class="headerlink" href="#reading-the-outputs" title="Link to this heading"></a></h2>
<p>As steps of the algorithm are completed, intermediate outputs are written to disk in the form of <code class="docutils literal notranslate"><span class="pre">.npz</span></code> numpy dictionary files.
If a run is interrupted for any reason, it can be restarted from the previously completed checkpoint.
The files written to disk are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">files.npz</span></code></p>
<ul>
<li><p>All specifiers to indicate which maps files are used</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">masks.npz</span></code></p>
<ul>
<li><p>The cross-spectra of the masks</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">kernels.npz</span></code></p>
<ul>
<li><p>The <span class="math notranslate nohighlight">\(K_{\ell\ell'}\)</span> mode-coupling kernels</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">sims_xcorr.npz</span></code></p>
<ul>
<li><p>The cross-spectra of signal and noise simulation</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">beam.npz</span></code></p>
<ul>
<li><p>The beam window functions, per map</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">transfer.npz</span></code></p>
<ul>
<li><p>The filter transfer functions, computed per map</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">data_xcorr.npz</span></code></p>
<ul>
<li><p>The cross-spectra of all the data maps</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">bandpowers.npz</span></code></p>
<ul>
<li><p>The computed bandpowers</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">likelihoods.npz</span></code></p>
<ul>
<li><p>The likelihoods for parameters</p></li>
</ul>
</li>
</ul>
<p>For a detailed overview of the various fields contained in each dictionary, see <a class="reference internal" href="notebooks/XFaster_Tutorial.html#Tutorial"><span class="std std-ref">Tutorial</span></a>.</p>
<p>To get a quick look at the data, you can use the <code class="docutils literal notranslate"><span class="pre">xfaster</span> <span class="pre">dump</span></code> command-line utility.  For example, to see the contents of the <code class="docutils literal notranslate"><span class="pre">data_xcorr.npz</span></code> checkpoint file for the example dataset:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>xfaster<span class="w"> </span>dump<span class="w"> </span>-r<span class="w"> </span>example/outputs_example<span class="w"> </span>-t<span class="w"> </span>95x150<span class="w"> </span>-c<span class="w"> </span>data
*****<span class="w"> </span>example/outputs_example/95x150/data_xcorr_95x150.npz<span class="w"> </span>*****
<span class="o">{</span>
<span class="w">    </span><span class="s1">&#39;data_version&#39;</span>:<span class="w"> </span><span class="m">4</span>,
<span class="w">    </span><span class="s1">&#39;cls_data&#39;</span>:<span class="w"> </span>odict_keys<span class="o">([</span><span class="s1">&#39;tt&#39;</span>,<span class="w"> </span><span class="s1">&#39;ee&#39;</span>,<span class="w"> </span><span class="s1">&#39;bb&#39;</span>,<span class="w"> </span><span class="s1">&#39;te&#39;</span>,<span class="w"> </span><span class="s1">&#39;eb&#39;</span>,<span class="w"> </span><span class="s1">&#39;tb&#39;</span><span class="o">])</span>,
<span class="w">    </span><span class="s1">&#39;nside&#39;</span>:<span class="w"> </span><span class="m">256</span>,
<span class="w">    </span><span class="s1">&#39;data_type&#39;</span>:<span class="w"> </span><span class="s1">&#39;raw&#39;</span>,
<span class="w">    </span><span class="s1">&#39;map_root&#39;</span>:<span class="w"> </span><span class="s1">&#39;data_raw&#39;</span>,
<span class="w">    </span><span class="s1">&#39;map_files&#39;</span>:<span class="w"> </span><span class="o">[</span><span class="s1">&#39;data_raw/full/map_150.fits&#39;</span>,<span class="w"> </span><span class="s1">&#39;data_raw/full/map_95.fits&#39;</span><span class="o">]</span>,
<span class="o">}</span>
</pre></div>
</div>
<p>Whenever you want to read in some data the XFaster code wrote, you’ll want to use the function <code class="docutils literal notranslate"><span class="pre">load_and_parse</span></code>.
This includes all the files detailed in the list above.
You can then look through keys, where the dictionaries are all structured as <code class="docutils literal notranslate"><span class="pre">main</span> <span class="pre">field</span> <span class="pre">name</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">spectrum</span> <span class="pre">type</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">map/cross</span> <span class="pre">spectrum</span></code>.</p>
<p>In the last category, cross spectra are indicated with a colon, so if I had two maps tagged as <code class="docutils literal notranslate"><span class="pre">95</span></code> and <code class="docutils literal notranslate"><span class="pre">150</span></code> that I’m inputting the algorithm, the spectrum fields I should find are <code class="docutils literal notranslate"><span class="pre">95:95</span></code>, <code class="docutils literal notranslate"><span class="pre">150:150</span></code>, and <code class="docutils literal notranslate"><span class="pre">150:95</span></code> (crosses are in alphabetical error, as they are read as strings).
Here, we have the two map auto-spectra first, and then the cross between them.
If there are multiple maps with the same tag but that use different &lt;&lt;data_subsets&gt;&gt; as described in <a class="reference internal" href="notebooks/XFaster_Tutorial.html#Maps"><span class="std std-ref">Maps</span></a> above, these will be assigned an additional numerical tag, so you might have something like <code class="docutils literal notranslate"><span class="pre">95_0:95_1</span></code> for the cross between map 95 in data_subset1 and data_subset2.</p>
<p>Below, we show how to load up some bandpowers, error bars, transfer function, and r-likelihood from the example script outputs.
This script is also in the repo: <a class="reference external" href="https://github.com/SPIDERCMB/xfaster/blob/main/example/plot_outputs.py">xfaster/example/plot_outputs.py</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xfaster</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xf</span>

<span class="c1"># First, load up inputs to our sims so we can check how well they&#39;re recovered</span>
<span class="c1"># (bearing in mind, this is a single sim, so noise fluctuations and sample</span>
<span class="c1"># variance will cause scatter.</span>
<span class="n">r_in</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">Dls_in</span> <span class="o">=</span> <span class="n">xf</span><span class="o">.</span><span class="n">get_camb_cl</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">r_in</span><span class="p">,</span> <span class="n">lmax</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">lfac</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Fl_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;maps_example/transfer_example.txt&quot;</span><span class="p">)</span>

<span class="c1"># load up bandpowers file, where most of the useful stuff is stored</span>
<span class="n">bp</span> <span class="o">=</span> <span class="n">xf</span><span class="o">.</span><span class="n">load_and_parse</span><span class="p">(</span><span class="s2">&quot;outputs_example/95x150/bandpowers_95x150.npz&quot;</span><span class="p">)</span>
<span class="n">ee_bin_centers</span> <span class="o">=</span> <span class="n">bp</span><span class="p">[</span><span class="s2">&quot;ellb&quot;</span><span class="p">][</span><span class="s2">&quot;cmb_ee&quot;</span><span class="p">]</span>  <span class="c1"># weighted bin centers</span>
<span class="n">ee_specs</span> <span class="o">=</span> <span class="n">bp</span><span class="p">[</span><span class="s2">&quot;cb&quot;</span><span class="p">][</span><span class="s2">&quot;cmb_ee&quot;</span><span class="p">]</span>  <span class="c1"># estimated CMB spectra with ell*(ell+1)/(2pi) factors</span>
<span class="n">ee_errs</span> <span class="o">=</span> <span class="n">bp</span><span class="p">[</span><span class="s2">&quot;dcb&quot;</span><span class="p">][</span><span class="s2">&quot;cmb_ee&quot;</span><span class="p">]</span>  <span class="c1"># estimated CMB error bars</span>
<span class="n">spec_cov</span> <span class="o">=</span> <span class="n">bp</span><span class="p">[</span><span class="s2">&quot;cov&quot;</span><span class="p">]</span>  <span class="c1"># Nspec * Nbin square covariance matrix</span>
<span class="n">ee_transfer_150</span> <span class="o">=</span> <span class="n">bp</span><span class="p">[</span><span class="s2">&quot;qb_transfer&quot;</span><span class="p">][</span><span class="s2">&quot;cmb_ee&quot;</span><span class="p">][</span><span class="s2">&quot;150&quot;</span><span class="p">]</span>  <span class="c1"># transfer function using the same bins</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Fl_in</span><span class="p">[:</span><span class="mi">500</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Input Transfer Function&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ee_bin_centers</span><span class="p">,</span> <span class="n">ee_transfer_150</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Estimated Transfer Function&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$F_\ell^</span><span class="si">{EE}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\ell$&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Dls_in</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Input CMB&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">ee_bin_centers</span><span class="p">,</span> <span class="n">ee_specs</span><span class="p">,</span> <span class="n">ee_errs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Output CMB Estimate&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\ell(\ell+1)C_\ell^</span><span class="si">{EE}</span><span class="s2">/2\pi\, [\mu K_</span><span class="si">{CMB}</span><span class="s2">]$&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\ell$&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Now get r-likelihood-- should be near the input r=1, but with scatter since it&#39;s</span>
<span class="c1"># just one sim realization</span>
<span class="n">lk</span> <span class="o">=</span> <span class="n">xf</span><span class="o">.</span><span class="n">load_and_parse</span><span class="p">(</span><span class="s2">&quot;outputs_example/95x150/like_mcmc_95x150.npz&quot;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">r_in</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Input r&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">lk</span><span class="p">[</span><span class="s2">&quot;samples&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;r posterior&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$r$&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;outputs_example.png&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The results should look like what’s shown below.
We recover our inputs pretty well within expected noise and signal variance.
Recovery is a bit worse at high ell because we aren’t accounting for leakage from even higher up bins– you’ll want to use an <span class="math notranslate nohighlight">\(\ell_{max}\)</span> a bit above what you plan to use for analysis for this reason.</p>
<a class="reference internal image-reference" href="_images/outputs_example.png"><img alt="_images/outputs_example.png" src="_images/outputs_example.png" style="width: 400px;" />
</a>
<p>And that covers the basics!</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="XFaster Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="algorithm.html" class="btn btn-neutral float-right" title="Algorithm" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, A. Gambrel, A. Rahlin, C. Contaldi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>